
<!--
  Mintest Forum Recovery Project (by sorcerykid)

  https://sorcerykid.github.io/minetest-forums/pages/47_22519.htm

  The following page was cached by Yandex Bot (https://yandex.com/) on 13-Apr-2019.
  All archived content is subject to copyright. No warranty or guaranty is implied.
-->
<base href="https://forum.minetest.net/" />
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-gb" xml:lang="en-gb">
<head>

<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="content-language" content="en-gb" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="keywords" content="" />
<meta name="description" content="" />

<title>Minetest Forums &bull; View topic - Animated sprites</title>

<link rel="alternate" type="application/atom+xml" title="Feed - Minetest Forums" href="https://forum.minetest.net/feed.php" /><link rel="alternate" type="application/atom+xml" title="Feed - New Topics" href="https://forum.minetest.net/feed.php?mode=topics" /><link rel="alternate" type="application/atom+xml" title="Feed - Forum - Mods" href="https://forum.minetest.net/feed.php?f=46" /><link rel="alternate" type="application/atom+xml" title="Feed - Topic - Animated sprites" href="https://forum.minetest.net/feed.php?f=47&amp;t=22519" />

<!--
	phpBB style name: prosilver
	Based on style:   prosilver (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:
-->

<link href="./styles/prosilver/theme/print.css" rel="stylesheet" type="text/css" media="print" title="printonly" />
<link href="./style.php?id=5&amp;lang=en" rel="stylesheet" type="text/css" media="screen, projection" />

<link href="./styles/prosilver/theme/normal.css" rel="stylesheet" type="text/css" title="A" />
<link href="./styles/prosilver/theme/medium.css" rel="alternate stylesheet" type="text/css" title="A+" />
<link href="./styles/prosilver/theme/large.css" rel="alternate stylesheet" type="text/css" title="A++" />

</head>

<body id="phpbb" class="section-viewtopic ltr">

<div id="wrap">
	<a id="top" name="top" accesskey="t"></a>
	<div id="page-header">
		<div class="headerbar">
			<div class="inner"><span class="corners-top"><span></span></span>

			<div id="site-description">
				<a href="./index.php" title="Board index" id="logo"><img src="./styles/prosilver/imageset/site_logo.gif" width="149" height="52" alt="" title="" /></a>
				<h1>Minetest Forums</h1>
				<p>The official Minetest discussion board</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

			<span class="corners-bottom"><span></span></span></div>
		</div>

		<div class="navbar">
			<div class="inner"><span class="corners-top"><span></span></span>

			<ul class="linklist navlinks">
				<li class="icon-home"><a href="./index.php" accesskey="h">Board index</a> <strong>&#8249;</strong> <a href="./viewforum.php?f=47">Modding Discussion</a></li>
			</ul>

			<span class="corners-bottom"><span></span></span></div>
		</div>
	</div>

	<a name="start_here"></a>
	<div id="page-body">
		
<h2><a href="./viewtopic.php?f=46&amp;t=22519">Animated sprites</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->

<div class="topic-actions">
		<div class="pagination">
			2 posts
			 &bull; Page <strong>1</strong> of <strong>1</strong>
		</div>
</div>
<div class="clear"></div>

	<div id="p348562" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			<h3 class="first"><a href="https://sorcerykid.github.io/minetest-forums/pages/pages/47_22519.htm#p348562">Animated sprites</a></h3>
			<p class="author"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>Casimir</strong> &raquo; Wed Apr 10, 2019 20:41 </p>

			<div class="content">Is is possible to make animated sprites (for mobs)? The lua_api is confusing and I don't get it to work.<br />Also what are &quot;LuaEntitySAO&quot;? Can set_sprite/spritesheets still be used or are they broken?</div>
		</div>

			<dl class="postprofile">
			<dt>
				<strong>Casimir</strong>
			</dt>
			<dd></dd>

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 1165</dd><dd><strong>Joined:</strong> Fri Aug 03, 2012 16:59</dd>
		<!--	<dd><strong>GitHub:</strong> %MEMBER_GITHUB_HANDLE%</dd>
			<dd><strong>IRC:</strong> %MEMBER_IRC_HANDLE%</dd> -->
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />
	<div id="p348633" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			<h3 class=""><a href="https://sorcerykid.github.io/minetest-forums/pages/pages/47_22519.htm#p348633">Re: Animated sprites</a></h3>
			<p class="author"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>v-rob</strong> &raquo; Thu Apr 11, 2019 23:41 </p>

			<div class="content">This is possible.  I experimented around with it quite a while ago.<br /><br />So, if you have an entity definition table called &quot;my_entity&quot;, you would have to use self.object:set_sprite in one of the functions, like on_activate.  In lua_api.txt, it is described as <span style="color: #000000; background-color: #ffffff; font: 0.9em Monaco, 'Andale Mono','Courier New', Courier, mono; border: 1px solid #d8d8d8;">set_sprite&#40;p, num_frames, framelength, select_horiz_by_yawpitch&#41;</span><br /><br /><span style="color: #000000; background-color: #ffffff; font: 0.9em Monaco, 'Andale Mono','Courier New', Courier, mono; border: 1px solid #d8d8d8;">p</span> is the coordinate of the first animation tile of the entity.  Probably {x=0, y=0} in most cases, as this is the top left corner of the image file.<br /><span style="color: #000000; background-color: #ffffff; font: 0.9em Monaco, 'Andale Mono','Courier New', Courier, mono; border: 1px solid #d8d8d8;">num_frames</span> is the number of animation tiles there are.  Obviously more than 1 if you want any animation at all.<br /><span style="color: #000000; background-color: #ffffff; font: 0.9em Monaco, 'Andale Mono','Courier New', Courier, mono; border: 1px solid #d8d8d8;">framelength</span> is how long each tile is shown.<br /><span style="color: #000000; background-color: #ffffff; font: 0.9em Monaco, 'Andale Mono','Courier New', Courier, mono; border: 1px solid #d8d8d8;">select_horiz_by_yawpitch</span> is an interesting option.  If true, it allows you to make things like the dungeon master in the early games.  So, if the player is facing the side of the dungeon master, you will see the vertical tiles a few rows over on the image.<br /><br />Next, in the object properties, you have to have <span style="color: #000000; background-color: #ffffff; font: 0.9em Monaco, 'Andale Mono','Courier New', Courier, mono; border: 1px solid #d8d8d8;">spritediv = {x=[width of spritesheet], y=[height of spritesheet]}</span>.  If you also have <span style="color: #000000; background-color: #ffffff; font: 0.9em Monaco, 'Andale Mono','Courier New', Courier, mono; border: 1px solid #d8d8d8;">initial_sprite_basepos = {x=[number], y = [number]}</span>, this will define the first sprite to be used in the sprite sheet, in case you want them to be animated starting with a different tile.<br /><br />So, if you want to make an exact clone of the original dungeon master, your code would look something like this (only relevant parts included):<br /><br /><img src="https://forum.minetest.net/download/file.php?id=18750" alt="Image" /><br /><br /><dl class="codebox"><dt>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code>local my_entity = {<br />&nbsp; &nbsp; initial_properties = {<br />&nbsp; &nbsp; &nbsp; &nbsp; ...<br />&nbsp; &nbsp; &nbsp; &nbsp; visual = &quot;sprite&quot;,<br />&nbsp; &nbsp; &nbsp; &nbsp; textures = {&quot;dungeon_master.png&quot;},<br />&nbsp; &nbsp; &nbsp; &nbsp; spritediv = {x=6, y=5}, -- size of sheet<br />&nbsp; &nbsp; &nbsp; &nbsp; initial_sprite_basepos = {x=0, y=0},<br />&nbsp; &nbsp; &nbsp; &nbsp; ...<br />&nbsp; &nbsp; },<br />&nbsp; &nbsp; ...<br />}<br /><br />function my_entity:on_activate(staticdata, dtime_s)<br />&nbsp; &nbsp; self.object:set_sprite({x=0, y=0}, 3, 0.5, true)<br />end<br /><br />minetest</nobr>.register_entity(&quot;my_mod:my_entity&quot;, my_entity)</code></dd></dl><br /><br />BTW, the background of the sprite has to be transparent, so don't include the red and yellow stuff in the image.<br /><br />As a last note, this only works with sprites.  Things like cubes or upright_sprites will not work with this.  I don't know if it's possible to make those have animations.</div>
		</div>

			<dl class="postprofile">
			<dt>
				<strong>v-rob</strong>
			</dt>
			<dd></dd>

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 617</dd><dd><strong>Joined:</strong> Thu Mar 24, 2016 03:19</dd>
		<!--	<dd><strong>GitHub:</strong> %MEMBER_GITHUB_HANDLE%</dd>
			<dd><strong>IRC:</strong> %MEMBER_IRC_HANDLE%</dd> -->
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<hr class="divider" />

	<hr />

<div class="topic-actions">
		<div class="pagination">
			2 posts
			 &bull; Page <strong>1</strong> of <strong>1</strong>
		</div>
</div>

	<p></p><p><a href="./viewforum.php?f=47" class="left-box left" accesskey="r">Return to Modding Discussion</a></p>

	<br /><br />

	<h3>Who is online</h3>
	<p>Users browsing this forum: <span style="color: #9E8DA7;" class="username-coloured">Yandex Bot [Bot]</span> and 0 guests</p>
</div>

<div id="page-footer">

	<div class="navbar">
		<div class="inner"><span class="corners-top"><span></span></span>

		<ul class="linklist">
			<li class="icon-home"><a href="./index.php">Board index</a></li>
				
			<li class="rightside">All times are UTC </li>
		</ul>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<div class="copyright">Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group
		
	</div>
</div>

</div>

<div>
	<a id="bottom" name="bottom" accesskey="z"></a>
	
</div>

</body>
</html></div>
