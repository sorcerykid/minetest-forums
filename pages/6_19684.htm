
<!--
  Mintest Forum Recovery Project (by sorcerykid)

  https://sorcerykid.github.io/minetest-forums/pages/6_19684.htm

  The following page was cached by Bing Bot (https://bing.com/) on 16-Apr-2019.
  All archived content is subject to copyright. No warranty or guaranty is implied.
-->
<base href="https://forum.minetest.net/" />
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-gb" xml:lang="en-gb">
<head>

<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="content-language" content="en-gb" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="keywords" content="" />
<meta name="description" content="" />

<title>Minetest Forums &bull; View topic - Is there any easy lag-free way to block IP ranges?</title>

<link rel="alternate" type="application/atom+xml" title="Feed - Minetest Forums" href="https://forum.minetest.net/feed.php" /><link rel="alternate" type="application/atom+xml" title="Feed - New Topics" href="https://forum.minetest.net/feed.php?mode=topics" /><link rel="alternate" type="application/atom+xml" title="Feed - Forum - Mods" href="https://forum.minetest.net/feed.php?f=46" /><link rel="alternate" type="application/atom+xml" title="Feed - Topic - Is there any easy lag-free way to block IP ranges?" href="https://forum.minetest.net/feed.php?f=6&amp;t=19684" />

<!--
	phpBB style name: prosilver
	Based on style:   prosilver (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:
-->

<link href="./styles/prosilver/theme/print.css" rel="stylesheet" type="text/css" media="print" title="printonly" />
<link href="./style.php?id=5&amp;lang=en" rel="stylesheet" type="text/css" media="screen, projection" />

<link href="./styles/prosilver/theme/normal.css" rel="stylesheet" type="text/css" title="A" />
<link href="./styles/prosilver/theme/medium.css" rel="alternate stylesheet" type="text/css" title="A+" />
<link href="./styles/prosilver/theme/large.css" rel="alternate stylesheet" type="text/css" title="A++" />

</head>

<body id="phpbb" class="section-viewtopic ltr">

<div id="wrap">
	<a id="top" name="top" accesskey="t"></a>
	<div id="page-header">
		<div class="headerbar">
			<div class="inner"><span class="corners-top"><span></span></span>

			<div id="site-description">
				<a href="./index.php" title="Board index" id="logo"><img src="./styles/prosilver/imageset/site_logo.gif" width="149" height="52" alt="" title="" /></a>
				<h1>Minetest Forums</h1>
				<p>The official Minetest discussion board</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

			<span class="corners-bottom"><span></span></span></div>
		</div>

		<div class="navbar">
			<div class="inner"><span class="corners-top"><span></span></span>

			<ul class="linklist navlinks">
				<li class="icon-home"><a href="./index.php" accesskey="h">Board index</a> <strong>&#8249;</strong> <a href="./viewforum.php?f=6">Problems</a></li>
			</ul>

			<span class="corners-bottom"><span></span></span></div>
		</div>
	</div>

	<a name="start_here"></a>
	<div id="page-body">
		
<h2><a href="./viewtopic.php?f=46&amp;t=19684">Is there any easy lag-free way to block IP ranges?</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->

<div class="topic-actions">
		<div class="pagination">
			21 posts
			 &bull; Page <strong>1</strong> of <strong>1</strong>
		</div>
</div>
<div class="clear"></div>

	<div id="p312542" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			<h3 class="first"><a href="https://sorcerykid.github.io/minetest-forums/pages/6_19684.htm#p312542">Is there any easy lag-free way to block IP ranges?</a></h3>
			<p class="author"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>redblade7</strong> &raquo; Wed Feb 21, 2018 3:21 pm </p>

			<div class="content">Hi,<br /><br />I need a way to block IP ranges, to block griefers who have several IDs consisting of different IPs in the same two ranges, as well as people who have made threats to hack my server.<br /><br />The only way I know of that would do this would be iptables, but inspecting every single packet against hundreds or thousands of IPs in the block causes 20-40+ lag on my servers, making the game near unplayable for most.<br /><br />I'd imagine I could spend hours placing 255 sets of IPs into ipban.txt or xban2 one at a time. But there has to be a better way, perhaps a Linux program separate from iptables that won't cause so much lag. Is there?</div>
		</div>

			<dl class="postprofile">
			<dt>
				<strong>redblade7</strong>
			</dt>
			<dd>Member</dd>

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 240</dd><dd><strong>Joined:</strong> Sun Feb 15, 2015 7:14 am</dd>
			
			<dd><strong>In-game:</strong> redblade7 redblade7_owner</dd>
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />
	<div id="p312549" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			<h3 class=""><a href="https://sorcerykid.github.io/minetest-forums/pages/6_19684.htm#p312549">Re: Is there any easy lag-free way to block IP ranges?</a></h3>
			<p class="author"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>rubenwardy</strong> &raquo; Wed Feb 21, 2018 5:03 pm </p>

			<div class="content">you could create a mod to check the IP against the range on_joinplayer</div>
		</div>

			<dl class="postprofile">
			<dt>
				<strong>rubenwardy</strong>
			</dt>
			<dd>Moderator</dd>

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 5725</dd><dd><strong>Joined:</strong> Tue Jun 12, 2012 6:11 pm</dd>
			<dd><strong>GitHub:</strong> rubenwardy</dd>
			<dd><strong>In-game:</strong> rubenwardy</dd>
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />
	<div id="p312551" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			<h3 class="first"><a href="https://sorcerykid.github.io/minetest-forums/pages/6_19684.htm#p312551">Re: Is there any easy lag-free way to block IP ranges?</a></h3>
			<p class="author"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>redblade7</strong> &raquo; Wed Feb 21, 2018 5:26 pm </p>

			<div class="content"><blockquote><div><cite>rubenwardy wrote:</cite>you could create a mod to check the IP against the range on_joinplayer</div></blockquote><br /><br />I don't know how to create mods, and I don't know what on_joinplayer is. Does anything exist, even something that has nothing to do with Minetest? (Preferably something that has nothing to do with Minetest.)</div>
		</div>

			<dl class="postprofile">
			<dt>
				<strong>redblade7</strong>
			</dt>
			<dd>Member</dd>

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 240</dd><dd><strong>Joined:</strong> Sun Feb 15, 2015 7:14 am</dd>
			
			<dd><strong>In-game:</strong> redblade7 redblade7_owner</dd>
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />
	<div id="p312619" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			<h3 class=""><a href="https://sorcerykid.github.io/minetest-forums/pages/6_19684.htm#p312619">Re: Is there any easy lag-free way to block IP ranges?</a></h3>
			<p class="author"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>Vapalus</strong> &raquo; Thu Feb 22, 2018 8:44 am </p>

			<div class="content">Since you are talking about iptables and supposedly have linux:<br /><span style="font-weight: bold">ip route add blackhole 192.168.178.5/29</span> is the way to go there...<br />192.168.178.5 is the IP, /29 is the bitmask to use for the range.<br /><!-- m --><a class="postlink" href="https://www.aelius.com/njh/subnet_sheet.html">https://www.aelius.com/njh/subnet_sheet.html</a><!-- m --></div>
		</div>

			<dl class="postprofile">
			<dt>
				<strong>Vapalus</strong>
			</dt>
			<dd>Member</dd>

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 113</dd><dd><strong>Joined:</strong> Wed Nov 15, 2017 5:16 pm</dd>
			
			
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />
	<div id="p312621" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			<h3 class="first"><a href="https://sorcerykid.github.io/minetest-forums/pages/6_19684.htm#p312621">Re: Is there any easy lag-free way to block IP ranges?</a></h3>
			<p class="author"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>redblade7</strong> &raquo; Thu Feb 22, 2018 9:16 am </p>

			<div class="content"><blockquote><div><cite>Vapalus wrote:</cite>Since you are talking about iptables and supposedly have linux:<br /><span style="font-weight: bold">ip route add blackhole 192.168.178.5/29</span> is the way to go there...<br />192.168.178.5 is the IP, /29 is the bitmask to use for the range.<br /><!-- m --><a class="postlink" href="https://www.aelius.com/njh/subnet_sheet.html">https://www.aelius.com/njh/subnet_sheet.html</a><!-- m --></div></blockquote><br /><br />Will that avoid the lag issues I just described when doing it via iptables?</div>
		</div>

			<dl class="postprofile">
			<dt>
				<strong>redblade7</strong>
			</dt>
			<dd>Member</dd>

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 240</dd><dd><strong>Joined:</strong> Sun Feb 15, 2015 7:14 am</dd>
			
			<dd><strong>In-game:</strong> redblade7 redblade7_owner</dd>
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />
	<div id="p312624" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			<h3 class=""><a href="https://sorcerykid.github.io/minetest-forums/pages/6_19684.htm#p312624">Re: Is there any easy lag-free way to block IP ranges?</a></h3>
			<p class="author"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>Vapalus</strong> &raquo; Thu Feb 22, 2018 10:20 am </p>

			<div class="content">I had a big server with, let's say, 5.000 - 10.000 players once, on a pretty normal hardware, with all the stuff that comes with it;  DoS, cheaters, hacking attempts, and the blackhole did a pretty fine job.<br />It's down to the OS level and doesn't even react to IPs from  the given range.<br /><br /><!-- m --><a class="postlink" href="https://vincent.bernat.im/en/blog/2017-ipv4-route-lookup-linux">https://vincent.bernat.im/en/blog/2017- ... okup-linux</a><!-- m --><br /><br />It's talking about 50 ns here, but I guess that's processor related.</div>
		</div>

			<dl class="postprofile">
			<dt>
				<strong>Vapalus</strong>
			</dt>
			<dd>Member</dd>

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 113</dd><dd><strong>Joined:</strong> Wed Nov 15, 2017 5:16 pm</dd>
			
			
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />
	<div id="p313044" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			<h3 class="first"><a href="https://sorcerykid.github.io/minetest-forums/pages/6_19684.htm#p313044">Re: Is there any easy lag-free way to block IP ranges?</a></h3>
			<p class="author"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>redblade7</strong> &raquo; Wed Feb 28, 2018 12:36 am </p>

			<div class="content">&quot;ip route add blackhole&quot; on large ranges seems to introduce a bit of lag and slowness (probably about 2-10 at most) but not to the extent of being unplayable (the 20-40 I was getting with iptables). Thank you!</div>
		</div>

			<dl class="postprofile">
			<dt>
				<strong>redblade7</strong>
			</dt>
			<dd>Member</dd>

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 240</dd><dd><strong>Joined:</strong> Sun Feb 15, 2015 7:14 am</dd>
			
			<dd><strong>In-game:</strong> redblade7 redblade7_owner</dd>
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />
	<div id="p313048" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			<h3 class=""><a href="https://sorcerykid.github.io/minetest-forums/pages/6_19684.htm#p313048">Re: Is there any easy lag-free way to block IP ranges?</a></h3>
			<p class="author"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>sofar</strong> &raquo; Wed Feb 28, 2018 1:16 am </p>

			<div class="content">The most efficient way on Linux is to use `ipset` as it can be used to define network ranges, and then block them using `iptables` if they match the `ipset`.<br /><br />There are many guides that cover the topic, here's one that I think does a good job: <!-- m --><a class="postlink" href="https://wiki.archlinux.org/index.php/Ipset">https://wiki.archlinux.org/index.php/Ipset</a><!-- m --></div>
		</div>

			<dl class="postprofile">
			<dt>
				<strong>sofar</strong>
			</dt>
			<dd>Developer</dd>

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 2059</dd><dd><strong>Joined:</strong> Fri Jan 16, 2015 7:31 am</dd>
			<dd><strong>GitHub:</strong> sofar</dd>
			<dd><strong>In-game:</strong> sofar</dd>
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />
	<div id="p313049" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			<h3 class="first"><a href="https://sorcerykid.github.io/minetest-forums/pages/6_19684.htm#p313049">Re: Is there any easy lag-free way to block IP ranges?</a></h3>
			<p class="author"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>redblade7</strong> &raquo; Wed Feb 28, 2018 1:40 am </p>

			<div class="content"><blockquote><div><cite>sofar wrote:</cite>The most efficient way on Linux is to use `ipset` as it can be used to define network ranges, and then block them using `iptables` if they match the `ipset`.<br /><br />There are many guides that cover the topic, here's one that I think does a good job: <!-- m --><a class="postlink" href="https://wiki.archlinux.org/index.php/Ipset">https://wiki.archlinux.org/index.php/Ipset</a><!-- m --></div></blockquote><br /><br />How is that different from adding the ranges to an iptables config file manually (which was making the game unplayable)?</div>
		</div>

			<dl class="postprofile">
			<dt>
				<strong>redblade7</strong>
			</dt>
			<dd>Member</dd>

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 240</dd><dd><strong>Joined:</strong> Sun Feb 15, 2015 7:14 am</dd>
			
			<dd><strong>In-game:</strong> redblade7 redblade7_owner</dd>
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />
	<div id="p313052" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			<h3 class=""><a href="https://sorcerykid.github.io/minetest-forums/pages/6_19684.htm#p313052">Re: Is there any easy lag-free way to block IP ranges?</a></h3>
			<p class="author"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>zing269</strong> &raquo; Wed Feb 28, 2018 3:24 am </p>

			<div class="content"><blockquote><div><cite>redblade7 wrote:</cite>How is that different from adding the ranges to an iptables config file manually (which was making the game unplayable)?</div></blockquote><br /><br />It seems that there can be a significant improvement in the performance of iptables when the ipset utility is used. <br /><a href="https://developers.redhat.com/blog/2017/04/11/benchmarking-nftables/" class="postlink">https://developers.redhat.com/blog/2017/04/11/benchmarking-nftables/</a></div>
		</div>

			<dl class="postprofile">
			<dt>
				<strong>zing269</strong>
			</dt>
			<dd>Member</dd>

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 71</dd><dd><strong>Joined:</strong> Sat Apr 30, 2016 7:10 pm</dd>
			
			
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />
	<div id="p313054" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			<h3 class="first"><a href="https://sorcerykid.github.io/minetest-forums/pages/6_19684.htm#p313054">Re: Is there any easy lag-free way to block IP ranges?</a></h3>
			<p class="author"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>sofar</strong> &raquo; Wed Feb 28, 2018 4:22 am </p>

			<div class="content"><blockquote><div><cite>zing269 wrote:</cite><blockquote><div><cite>redblade7 wrote:</cite>How is that different from adding the ranges to an iptables config file manually (which was making the game unplayable)?</div></blockquote><br /><br />It seems that there can be a significant improvement in the performance of iptables when the ipset utility is used. <br /><a href="https://developers.redhat.com/blog/2017/04/11/benchmarking-nftables/" class="postlink">https://developers.redhat.com/blog/2017/04/11/benchmarking-nftables/</a></div></blockquote><br /><br />Iptables is a highly complex system. Each rule has significant execution time, although I doubt that on any decent hardware you'd even notice a few rules (do you run on a really low end machine?). However, ipset is a really specific addition that avoids most of the iptables performance issues and offers enough functionality to replace things like blocklists for IP ranges easily. You only then need *one* iptables rule, so the performance hit is a lot smaller than with everything in lots of iptables rules.</div>
		</div>

			<dl class="postprofile">
			<dt>
				<strong>sofar</strong>
			</dt>
			<dd>Developer</dd>

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 2059</dd><dd><strong>Joined:</strong> Fri Jan 16, 2015 7:31 am</dd>
			<dd><strong>GitHub:</strong> sofar</dd>
			<dd><strong>In-game:</strong> sofar</dd>
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />
	<div id="p313081" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			<h3 class=""><a href="https://sorcerykid.github.io/minetest-forums/pages/6_19684.htm#p313081">Re: Is there any easy lag-free way to block IP ranges?</a></h3>
			<p class="author"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>Vapalus</strong> &raquo; Wed Feb 28, 2018 1:47 pm </p>

			<div class="content">The fact that he has a feelable speed decrease on blackhole must mean he's running it on a RasPi, or something like that.</div>
		</div>

			<dl class="postprofile">
			<dt>
				<strong>Vapalus</strong>
			</dt>
			<dd>Member</dd>

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 113</dd><dd><strong>Joined:</strong> Wed Nov 15, 2017 5:16 pm</dd>
			
			
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />
	<div id="p313781" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			<h3 class="first"><a href="https://sorcerykid.github.io/minetest-forums/pages/6_19684.htm#p313781">Re: Is there any easy lag-free way to block IP ranges?</a></h3>
			<p class="author"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>redblade7</strong> &raquo; Thu Mar 08, 2018 4:48 pm </p>

			<div class="content"><blockquote><div><cite>Vapalus wrote:</cite>The fact that he has a feelable speed decrease on blackhole must mean he's running it on a RasPi, or something like that.</div></blockquote><br /><br />I'm running it on a VPS, provider is Linode. I have hundreds of thousands of IPs blackholed though.</div>
		</div>

			<dl class="postprofile">
			<dt>
				<strong>redblade7</strong>
			</dt>
			<dd>Member</dd>

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 240</dd><dd><strong>Joined:</strong> Sun Feb 15, 2015 7:14 am</dd>
			
			<dd><strong>In-game:</strong> redblade7 redblade7_owner</dd>
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />
	<div id="p313790" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			<h3 class=""><a href="https://sorcerykid.github.io/minetest-forums/pages/6_19684.htm#p313790">Re: Is there any easy lag-free way to block IP ranges?</a></h3>
			<p class="author"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>hajo</strong> &raquo; Thu Mar 08, 2018 6:02 pm </p>

			<div class="content"><blockquote><div><cite>redblade7 wrote:</cite>I need a way to block IP ranges, .. iptables, .. causes 20-40+ lag </div></blockquote><br />I don't think iptables is slow like that.<br /><br />Someone did a <a href="https://www.electricmonk.nl/log/2011/07/29/netfilter-iptables-performance-tests/" class="postlink">performance-test</a>, and found<br />&gt;The breaking point for Xeon is at about 30,000 new requests per second<br />&gt;netfilter/iptables does not scale well if one wants to use large number of rules in a single chain.<br /><br />So maybe your firewall-setup is just inefficent.<br /><br />See this post on <a href="https://unix.stackexchange.com/questions/161614/how-to-measure-iptables-load" class="postlink">stackexchange</a> :<br />&gt;I have added about 3500 IP addresses to iptables<br />&gt;&gt;setup an ipset instead</div>
		</div>

			<dl class="postprofile">
			<dt>
				<strong>hajo</strong>
			</dt>
			<dd>Member</dd>

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 596</dd><dd><strong>Joined:</strong> Thu Oct 13, 2016 10:45 am</dd>
			
			
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />
	<div id="p314943" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			<h3 class="first"><a href="https://sorcerykid.github.io/minetest-forums/pages/6_19684.htm#p314943">Re: Is there any easy lag-free way to block IP ranges?</a></h3>
			<p class="author"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>Vapalus</strong> &raquo; Thu Mar 22, 2018 2:47 pm </p>

			<div class="content"><blockquote><div><cite>redblade7 wrote:</cite>I'm running it on a VPS, provider is Linode. I have hundreds of thousands of IPs blackholed though.</div></blockquote><br /><br />I've been running stuff on a VPS, too, and never had any issues with using either iptables or blackhole.<br />The speed in which the OS does the paket handling is so extremely fast (50 nanoseconds!) that I have to doubt if your system is clean.<br /><br />If the light flies for 50 ns, it goes as far as 15 meters. A normal human should not be able to see, smell, hear or measure a difference of that timespan. What you are talking about, 5 ms, is like 100 times more than that.<br /><br />How do you measure the lag difference?</div>
		</div>

			<dl class="postprofile">
			<dt>
				<strong>Vapalus</strong>
			</dt>
			<dd>Member</dd>

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 113</dd><dd><strong>Joined:</strong> Wed Nov 15, 2017 5:16 pm</dd>
			
			
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />
	<div id="p315092" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			<h3 class=""><a href="https://sorcerykid.github.io/minetest-forums/pages/6_19684.htm#p315092">Re: Is there any easy lag-free way to block IP ranges?</a></h3>
			<p class="author"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>redblade7</strong> &raquo; Fri Mar 23, 2018 9:29 pm </p>

			<div class="content">Turns out that in addition to the blackholing I was just long overdue for a /clearobjects on that server (last time I did was over 6 months ago). It had gotten so bad that I was getting weird packet errors when trying to connect today. I hate doing a /clearobjects because everyone loses all their tamed animals and loose carts that way, but more mobs = more lag. After doing that, everything works fine with blackhole. Thank you!</div>
		</div>

			<dl class="postprofile">
			<dt>
				<strong>redblade7</strong>
			</dt>
			<dd>Member</dd>

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 240</dd><dd><strong>Joined:</strong> Sun Feb 15, 2015 7:14 am</dd>
			
			<dd><strong>In-game:</strong> redblade7 redblade7_owner</dd>
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />
	<div id="p317811" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			<h3 class="first"><a href="https://sorcerykid.github.io/minetest-forums/pages/6_19684.htm#p317811">Re: Is there any easy lag-free way to block IP ranges?</a></h3>
			<p class="author"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>redblade7</strong> &raquo; Fri May 04, 2018 9:05 pm </p>

			<div class="content"><blockquote><div><cite>redblade7 wrote:</cite>Turns out that in addition to the blackholing I was just long overdue for a /clearobjects on that server (last time I did was over 6 months ago). It had gotten so bad that I was getting weird packet errors when trying to connect today. I hate doing a /clearobjects because everyone loses all their tamed animals and loose carts that way, but more mobs = more lag. After doing that, everything works fine with blackhole. Thank you!</div></blockquote><br /><br />That and I've been getting endless about of ABMs caused by the instability of the bees mod, which is on two of my servers. After updating the mod to a beta (though also abandoned) version I was having crashes on a daily basis, but I found several problems in the code and after adding missing variables and commenting out extra features that I didn't want to be bothered figuring out, it seems to work fine. Thank you!</div>
		</div>

			<dl class="postprofile">
			<dt>
				<strong>redblade7</strong>
			</dt>
			<dd>Member</dd>

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 240</dd><dd><strong>Joined:</strong> Sun Feb 15, 2015 7:14 am</dd>
			
			<dd><strong>In-game:</strong> redblade7 redblade7_owner</dd>
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />
	<div id="p317817" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			<h3 class=""><a href="https://sorcerykid.github.io/minetest-forums/pages/6_19684.htm#p317817">Re: Is there any easy lag-free way to block IP ranges?</a></h3>
			<p class="author"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>Hamlet</strong> &raquo; Fri May 04, 2018 9:32 pm </p>

			<div class="content"><blockquote><div><cite>redblade7 wrote:</cite>Turns out that in addition to the blackholing I was just long overdue for a /clearobjects on that server (last time I did was over 6 months ago). It had gotten so bad that I was getting weird packet errors when trying to connect today. I hate doing a /clearobjects because everyone loses all their tamed animals and loose carts that way, but more mobs = more lag. After doing that, everything works fine with blackhole. Thank you!</div></blockquote><br /><br />Perhaps you've already done this, but I would suggest to reduce the Items' Entity Time To Live (item_entity_ttl); by default it is set to 900 (15mins)... I think that 300 (5mins) is more than enough for a player to recover what might have been dropped because of death or whatever the reason.</div>
		</div>

			<dl class="postprofile">
			<dt>
				<strong>Hamlet</strong>
			</dt>
			<dd>Member</dd>

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 465</dd><dd><strong>Joined:</strong> Sat Jul 29, 2017 9:09 pm</dd>
			<dd><strong>GitHub:</strong> MicroSoft is not OpenSource</dd>
			
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />
	<div id="p317821" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			<h3 class="first"><a href="https://sorcerykid.github.io/minetest-forums/pages/6_19684.htm#p317821">Re: Is there any easy lag-free way to block IP ranges?</a></h3>
			<p class="author"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>redblade7</strong> &raquo; Fri May 04, 2018 10:34 pm </p>

			<div class="content"><blockquote><div><cite>Hamlet wrote:</cite>Perhaps you've already done this, but I would suggest to reduce the Items' Entity Time To Live (item_entity_ttl); by default it is set to 900 (15mins)... I think that 300 (5mins) is more than enough for a player to recover what might have been dropped because of death or whatever the reason.</div></blockquote><br /><br />Yes, always had 300</div>
		</div>

			<dl class="postprofile">
			<dt>
				<strong>redblade7</strong>
			</dt>
			<dd>Member</dd>

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 240</dd><dd><strong>Joined:</strong> Sun Feb 15, 2015 7:14 am</dd>
			
			<dd><strong>In-game:</strong> redblade7 redblade7_owner</dd>
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />
	<div id="p318194" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			<h3 class=""><a href="https://sorcerykid.github.io/minetest-forums/pages/6_19684.htm#p318194">Re: Is there any easy lag-free way to block IP ranges?</a></h3>
			<p class="author"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>redblade7</strong> &raquo; Wed May 09, 2018 11:14 am </p>

			<div class="content">I just noticed that when I upgraded postgresql last, I had the config set up incorrectly, shared_buffers was set to 18MB instead of 18GB. I don't know what effect this typo would have had, but everything has been fine regardless.</div>
		</div>

			<dl class="postprofile">
			<dt>
				<strong>redblade7</strong>
			</dt>
			<dd>Member</dd>

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 240</dd><dd><strong>Joined:</strong> Sun Feb 15, 2015 7:14 am</dd>
			
			<dd><strong>In-game:</strong> redblade7 redblade7_owner</dd>
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />
	<div id="p347517" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			<h3 class="first"><a href="https://sorcerykid.github.io/minetest-forums/pages/6_19684.htm#p347517">Re: Is there any easy lag-free way to block IP ranges?</a></h3>
			<p class="author"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>sorcerykid</strong> &raquo; Fri Mar 29, 2019 10:20 pm </p>

			<div class="content">I know I'm chiming in a bit late, but I just  wanted to mention that it's possible to block IP address ranges using Auth Redux. Authentication rulesets can be edited and reloaded even while the server is running to block login attempts from malicious clients.<br /><br /><dl class="codebox"><dt>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code># block all IPs from 192.168 with third and fourth octets full range<br />when $addr is /192.168.?.?/a fail<br /><br /># block all IPs from 128.0.0 with fourth octet range 0 to10 inclusive<br />when $addr is /128.0.0.10&lt;/a fail<br /></code></dd></dl><br /><br />If you have a large number of individual IP addresses, then they can also be checked in a flat text file.</div>
		</div>

			<dl class="postprofile">
			<dt>
				<strong>sorcerykid</strong>
			</dt>
			<dd>Member</dd>

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 1025</dd><dd><strong>Joined:</strong> Fri Aug 26, 2016 3:36 pm</dd>
			<dd><strong>GitHub:</strong> sorcerykid</dd>
			<dd><strong>In-game:</strong> Nemo</dd>
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<hr class="divider" />

	<hr />

<div class="topic-actions">
		<div class="pagination">
			21 posts
			 &bull; Page <strong>1</strong> of <strong>1</strong>
		</div>
</div>

	<p></p><p><a href="./viewforum.php?f=6" class="left-box left" accesskey="r">Return to Problems</a></p>

	<br /><br />

	<h3>Who is online</h3>
	<p>Users browsing this forum: <span style="color: #9E8DA7;" class="username-coloured">Bing Bot [Bot]</span> and 0 guests</p>
</div>

<div id="page-footer">

	<div class="navbar">
		<div class="inner"><span class="corners-top"><span></span></span>

		<ul class="linklist">
			<li class="icon-home"><a href="./index.php">Board index</a></li>
				
			<li class="rightside">All times are UTC </li>
		</ul>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<div class="copyright">Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group
		
	</div>
</div>

</div>

<div>
	<a id="bottom" name="bottom" accesskey="z"></a>
	
</div>

</body>
</html></div>
