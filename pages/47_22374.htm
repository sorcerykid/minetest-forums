
<!--
  Mintest Forum Recovery Project (by sorcerykid)

  https://sorcerykid.github.io/minetest-forums/pages/47_22374.htm

  The following page was cached by Google Bot (https://google.com/) on 23-Mar-2019.
  All archived content is subject to copyright. No warranty or guaranty is implied.
-->
<base href="https://forum.minetest.net/" />
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-gb" xml:lang="en-gb">
<head>

<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="content-language" content="en-gb" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="keywords" content="" />
<meta name="description" content="" />

<title>Minetest Forums &bull; View topic - low lua memory issue and a missunderstanding ?</title>

<link rel="alternate" type="application/atom+xml" title="Feed - Minetest Forums" href="https://forum.minetest.net/feed.php" /><link rel="alternate" type="application/atom+xml" title="Feed - New Topics" href="https://forum.minetest.net/feed.php?mode=topics" /><link rel="alternate" type="application/atom+xml" title="Feed - Forum - Mods" href="https://forum.minetest.net/feed.php?f=46" /><link rel="alternate" type="application/atom+xml" title="Feed - Topic - low lua memory issue and a missunderstanding ?" href="https://forum.minetest.net/feed.php?f=47&amp;t=22374" />

<!--
	phpBB style name: prosilver
	Based on style:   prosilver (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:
-->

<link href="./styles/prosilver/theme/print.css" rel="stylesheet" type="text/css" media="print" title="printonly" />
<link href="./style.php?id=5&amp;lang=en" rel="stylesheet" type="text/css" media="screen, projection" />

<link href="./styles/prosilver/theme/normal.css" rel="stylesheet" type="text/css" title="A" />
<link href="./styles/prosilver/theme/medium.css" rel="alternate stylesheet" type="text/css" title="A+" />
<link href="./styles/prosilver/theme/large.css" rel="alternate stylesheet" type="text/css" title="A++" />

</head>

<body id="phpbb" class="section-viewtopic ltr">

<div id="wrap">
	<a id="top" name="top" accesskey="t"></a>
	<div id="page-header">
		<div class="headerbar">
			<div class="inner"><span class="corners-top"><span></span></span>

			<div id="site-description">
				<a href="./index.php" title="Board index" id="logo"><img src="./styles/prosilver/imageset/site_logo.gif" width="149" height="52" alt="" title="" /></a>
				<h1>Minetest Forums</h1>
				<p>The official Minetest discussion board</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

			<span class="corners-bottom"><span></span></span></div>
		</div>

		<div class="navbar">
			<div class="inner"><span class="corners-top"><span></span></span>

			<ul class="linklist navlinks">
				<li class="icon-home"><a href="./index.php" accesskey="h">Board index</a> <strong>&#8249;</strong> <a href="./viewforum.php?f=47">Modding Discussion</a></li>
			</ul>

			<span class="corners-bottom"><span></span></span></div>
		</div>
	</div>

	<a name="start_here"></a>
	<div id="page-body">
		
<h2><a href="./viewtopic.php?f=46&amp;t=22374">low lua memory issue and a missunderstanding ?</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->

<div class="topic-actions">
		<div class="pagination">
			5 posts
			 &bull; Page <strong>1</strong> of <strong>1</strong>
		</div>
</div>
<div class="clear"></div>

	<div id="p346637" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			<h3 class="first"><a href="https://sorcerykid.github.io/minetest-forums/pages/47_22374.htm#p346637">low lua memory issue and a missunderstanding ?</a></h3>
			<p class="author"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>Festus1965</strong> &raquo; Wed Mar 20, 2019 11:48 am </p>

			<div class="content">hello coders, programmers ... I learned some basic of this with the Commodore64 and sold first program to make inventory at years and faster at neighbour bakery somewhere in 1980 I think, during I was also visiting the first plusclass in programming on my middle school.<br />But after trainied in C++, Oracle, network and html + learn php in 200-2005, I quit my job and moved in another country ... whatever, and some basics of this old knowledge not changed yet.<br /><br />* No computer run without memory<br />* every code, whatever it does uses/consumes memory<br /><br />so depending on my research in low Lua memory, there is another fact I read<br />* 64 systems only give Lua/JIT 2 GB of ram, <br />* what is, depending on the system and code and version of lua and also not started at beginning, so that the we had the issue that OOM errors available memory are from just 14 MB up to my reported 1300 MB.<br /><br />So for clear, a [Mod] uses memory as it is loaded via its init.lua by set true in world.mt file, and the problem yet was, we had no Idea which mod uses how much (? solved ?), or further which one gains more (unsolved).<br /><br />So depending on my tick to ask after every loaded [Mod] the used lua mem with collectgarbage() (<a href="https://forum.minetest.net/viewtopic.php?f=6&amp;t=21934#p346562" class="postlink">see thread</a>)<br />and found out some very hungry mods listed there.<br /><br />So with this evidence in consumption I made an issues at the 3 main programmers and got an answer.<br /><blockquote class="uncited"><div>As I said before, moretrees does not use a significant amount of memory.  It's up to the engine to decide what to use and what not to.  Hell, the whole Dreambuilder modpack (which includes moretrees) is only 60 MB.<br />If you're running short on memory, get more.</div></blockquote><br /><br />So take a few facts:<br />* if I false this mod, mod will not load, mod will not consume memory !<br />mean, it is the code of the mod, the decision of the programmer, wanted to load data = use memory and responsible for that<br />-- sure it is my decision if i use this mods, but when it keeps like this, and I wanna use Luajit, then some mods will be out, and after I can proof that it runs then without OOM, sure I will issue an warning for this mods together with LuaJIT using ...<br /><br />* the engine is just doing what is coded in the mod, the engine does nothing load with out the code, belong to the code, as this is why after loading init.lua more memory of the available lua mem is used.<br />* yes getting more memory, by jump back to 32bit lua might help = 4 GB, if I am right,<br />-- sure the other solution is find out optimising Lua memory, getting more mem, or using better start position (waiting for LUA code upgrade)<br /><br />So your meaning, better facts ... about this story here ...</div>
		</div>

			<dl class="postprofile">
			<dt>
				<strong>Festus1965</strong>
			</dt>
			<dd>Member</dd>

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 747</dd><dd><strong>Joined:</strong> Sun Jan 03, 2016 11:58 am</dd>
			
			<dd><strong>In-game:</strong> Thomas Explorer</dd>
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />
	<div id="p346644" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			<h3 class=""><a href="https://sorcerykid.github.io/minetest-forums/pages/47_22374.htm#p346644">Re: low lua memory issue and a missunderstanding ?</a></h3>
			<p class="author"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>Linuxdirk</strong> &raquo; Wed Mar 20, 2019 12:36 pm </p>

			<div class="content"><blockquote><div><cite>Festus1965 wrote:</cite>So with this evidence in consumption I made an issues at the 3 main programmers and got an answer.<br /><blockquote class="uncited"><div> [...]If you're running short on memory, get more.</div></blockquote></div></blockquote><br />The problem with this is, that it does not work like this. It is easily possible to get OOM on all types of machines. I can get OOM on my 4 GB private hosted mini server, on my 8 GB office laptop, or on my 16 GB regular PC. Available system memory is simply irrelevant when using LuaJIT.</div>
		</div>

			<dl class="postprofile">
			<dt>
				<strong>Linuxdirk</strong>
			</dt>
			<dd>Member</dd>

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 1871</dd><dd><strong>Joined:</strong> Wed Sep 17, 2014 11:21 am</dd>
			
			<dd><strong>In-game:</strong> Linuxdirk</dd>
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />
	<div id="p346647" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			<h3 class="first"><a href="https://sorcerykid.github.io/minetest-forums/pages/47_22374.htm#p346647">Re: low lua memory issue and a missunderstanding ?</a></h3>
			<p class="author"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>Festus1965</strong> &raquo; Wed Mar 20, 2019 1:20 pm </p>

			<div class="content"><blockquote><div><cite>Linuxdirk wrote:</cite>The problem with this is, that it does not work like this. It is easily possible to get OOM on all types of machines. I can get OOM on my 4 GB private hosted mini server, on my 8 GB office laptop, or on my 16 GB regular PC. Available system memory is simply irrelevant when using LuaJIT.</div></blockquote><br /><br />I know that, using a 32 GB server, also 32 GB work PC, but one coder of mod doesn't know that ...<br />Lua mem is limited, sure - depending on 32 or 64 and so ..., so I have a border with 2 GB and less, depending on other problems I read.<br /><br />But anyway, as there IS a fixed border IN lua until now, coding mods MUST take care about this, and save as much as possible.<br /><br />I just banned<br />* moreblocks (used 11936 KB) ans<br />* etherreal (used 6928 KB) of my server<br />and instead of used 72930 KB before, now just 41091 KB are used, so much more time to OOM crash at also 2 mods gone that might consume more during work.<br />* even think about to ban moretrees (using 9592 KB), it there is no soon rebuild of the code or we get 4 GB lua mem.<br /><br />As technic with all parts together also is Top ranked (using near ~12000 KB) also nice to get low down it, as used to much on server now, just to cut it out.</div>
		</div>

			<dl class="postprofile">
			<dt>
				<strong>Festus1965</strong>
			</dt>
			<dd>Member</dd>

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 747</dd><dd><strong>Joined:</strong> Sun Jan 03, 2016 11:58 am</dd>
			
			<dd><strong>In-game:</strong> Thomas Explorer</dd>
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />
	<div id="p346653" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			<h3 class=""><a href="https://sorcerykid.github.io/minetest-forums/pages/47_22374.htm#p346653">Re: low lua memory issue and a missunderstanding ?</a></h3>
			<p class="author"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>Linuxdirk</strong> &raquo; Wed Mar 20, 2019 1:59 pm </p>

			<div class="content">Moretrees feels quite heavy, yes. The technic trinity (Mesecons, Pipeworks, Technic) likely is the heaviest combination of mods possible.</div>
		</div>

			<dl class="postprofile">
			<dt>
				<strong>Linuxdirk</strong>
			</dt>
			<dd>Member</dd>

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 1871</dd><dd><strong>Joined:</strong> Wed Sep 17, 2014 11:21 am</dd>
			
			<dd><strong>In-game:</strong> Linuxdirk</dd>
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />
	<div id="p346655" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			<h3 class="first"><a href="https://sorcerykid.github.io/minetest-forums/pages/47_22374.htm#p346655">Re: low lua memory issue and a missunderstanding ?</a></h3>
			<p class="author"><img src="./styles/prosilver/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" />by <strong>rubenwardy</strong> &raquo; Wed Mar 20, 2019 2:02 pm </p>

			<div class="content">To fix LuaJIT ooms:<br /><br /><ul><li>Use a GC64 build of LuaJIT</li><li>Use puc Lua</li><li>Find and fix/remove mods which use a lot of memory</li></ul><br /><blockquote><div><cite>Linuxdirk wrote:</cite>Moretrees feels quite heavy, yes. The technic trinity (Mesecons, Pipeworks, Technic) likely is the heaviest combination of mods possible.</div></blockquote><br /><br />Exactly this - every time I see OOM I think biomelibs or moretrees.</div>
		</div>

			<dl class="postprofile">
			<dt>
				<strong>rubenwardy</strong>
			</dt>
			<dd>Moderator</dd>

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 5685</dd><dd><strong>Joined:</strong> Tue Jun 12, 2012 6:11 pm</dd>
			<dd><strong>GitHub:</strong> rubenwardy</dd>
			<dd><strong>In-game:</strong> rubenwardy</dd>
		</dl>
	
		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<hr class="divider" />

	<hr />

<div class="topic-actions">
		<div class="pagination">
			5 posts
			 &bull; Page <strong>1</strong> of <strong>1</strong>
		</div>
</div>

	<p></p><p><a href="./viewforum.php?f=47" class="left-box left" accesskey="r">Return to Modding Discussion</a></p>

	<br /><br />

	<h3>Who is online</h3>
	<p>Users browsing this forum: <span style="color: #9E8DA7;" class="username-coloured">Google Bot [Bot]</span> and 0 guests</p>
</div>

<div id="page-footer">

	<div class="navbar">
		<div class="inner"><span class="corners-top"><span></span></span>

		<ul class="linklist">
			<li class="icon-home"><a href="./index.php">Board index</a></li>
				
			<li class="rightside">All times are UTC </li>
		</ul>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<div class="copyright">Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Group
		
	</div>
</div>

</div>

<div>
	<a id="bottom" name="bottom" accesskey="z"></a>
	
</div>

</body>
</html></div>
